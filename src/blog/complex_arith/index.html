<!DOCTYPE html>

<html>
<head>
	<title>{{ title }}</title>
	<link rel="stylesheet" type="text/css" href="/style_blue.css">
	<meta charset="UTF-8">
</head>
<body>
	{% include "header.html" %}
	<article>
		<h1>{{ title }}</h1>
		
		<p><a href="https://en.wikipedia.org/wiki/Complex_number">Complex numbers</a> have a wide range of applications including the previously discussed Fourier transform. This article doesn't aim to be an introduction for complex numbers, but rather discuss the various representations of them. I'm not going deep into the cubic equatations and the problems with the formulas discovered for it, but a quick rundown does not hurt:</p>
		
		<ol>
			<li>First, the need arised to express the square root of negative numbers, which were previously thought to be impossible. These were <b>imaginary numbers</b> and squaring one yielded a negative real number back. Also it is worth mentioning that an imaginary number corresponded to each negative real number.</li>
			<li>We wanted to keep these new numbers as compatible with our old systems as we could, so we could make some rearrangments:</li>
			
			{{ formula("def_rearrange.tex") }}
			
			<p>Now instead of keeping track of infinitely many imaginary numbers, we can reduce all of them to one, the simplest. Thus we can define j (or i as you prefer):</p>
			
			{{ formula("def_j.tex") }}
			
			<li>Finally we can combine real and imaginary numbers to get <b>complex numbers</b>:</li>
			
			{{ formula("def_34.tex") }}
			
			<div class="infobox info">
				<p>Just to be clear, reals are a subset of complex numbers, so 1, 2 and 3 will be complex as well.</p>
			</div>
		</ol>
		
		<h2>Basic operations</h2>
		
		<p>Complex numbers are defined by their real and imaginary parts. We can also represent them in a coordinate system, where the x axis represents the real part and y is imaginary.</p>
		
		<div class="horizontal_split">
			<div>
				{{ code("complex_34.c", "c") }}
			</div>
			<div>
				{{ formula("def_34.tex") }}
			</div>
			<div>
				<img src="media/coord_34.svg">
			</div>
		</div>
		
		<p><b>Addition</b> between two complex numbers is simple, just add their components independently, like you would do with vectors.</p>
		
		{{ code("complex_addition.c", "c") }}
		
		<div class="horizontal_split">
			<div>
				{{ formula("c_add.tex") }}
			</div>
			<div>
				<img src="media/c_add.svg">
			</div>
		</div>
		
		<p><b>Substraction</b> is pretty much the same:</p>
		
		{{ code("complex_substraction.c", "c") }}
		
		<div class="horizontal_split">
			<div>
				{{ formula("c_sub.tex") }}
			</div>
			<div>
				<img src="media/c_sub.svg">
			</div>
		</div>
		
		<p>Things get sligtly complicated with <b>multiplication</b>. The trick here is that we have to multiply two imaginary numbers, and they yield a real one but with a negative sign. This is also much harder to interpret geometrically, so I didn't include that representation <i>yet</i>.</p>
		
		{{ code("complex_multiplication.c", "c") }}
		
		{{ formula("c_mul.tex") }}
		
		<p>Before we continue, take a look at how many real operations did these functions cost. For addition and substraction we needed <span class="plt_green">two additions</span> and <span class="plt_green">substractions</span> respectively and for multiplication we had to do <span class="plt_yellow">four real multiplications</span>, <span class="plt_green">one addition</span> and <span class="plt_green">one substraction</span>.</p>
		
		<p>We can do better in terms of multiplications, if we use <b>Gauss' complex multiplication algorithm</b>. With the introduction of three intermediate variables, we could reduce the number of multiplications needed to three:</p>
		
		{{ formula("c_mul_gauss.tex") }}
		
		{{ code("complex_gauss.c", "c") }}
		
		<p>There are a few different ways to express this due to the symmetry but we can't go below <span class="plt_yellow">three multiplications</span>. Also we had to do now <span class="plt_green">three additions</span> and <span class="plt_green">two substractions</span>, a total of eight operations instead of six. Was this tradeoff really worth it?</p>
		
		<p>It depends on your hardware, and you should take a look at the timings each operation takes (<a href="https://www.agner.org/optimize/instruction_tables.pdf">example</a>). But as a general thumb of rule, we can make the following observations: addition and substraction cost the same, multiplication is slower and division is even slower.</p>
		
		<table style="font-size: 35px;">
			<tr><td><b>+ -</b></td><td width=200><img src="media/smiley_addsub.png" style="height: 50px;"></td></tr>
			<tr><td><b>*</b></td><td><img src="media/smiley_mul.png" style="height: 50px;"></td></tr>
			<tr><td><b>/</b></td><td><img src="media/smiley_div.png" style="height: 50px;"></td></tr>
		</table>
		
		<p>Also for now I'll refer substraction as addition for now to make things easier.</p>
		
		<p>Finally we need to do some work to get the <b>division</b> done:</p>
		
		{{ formula("c_div_1.tex", amsmath=False) }}
		
		<p>After expanding the fraction (with the <a href="https://en.wikipedia.org/wiki/Complex_conjugate">complex conjugate</a>), the imaginary terms from the denominator cancel themselves.</p>
		
		{{ formula("c_div_2.tex", amsmath=False) }}
		
		<p>Rearranging the terms:</p>
		
		{{ formula("c_div_3.tex", amsmath=False) }}
		
		<p>And in code form:</p>
		
		{{ code("complex_division.c", "c") }}
		
		<p>This method uses <span class="plt_green">three additions</span>, <span class="plt_yellow">six multiplications</span>, and <span class="plt_red">two divisions</span>. Not the fastest method, can we make some accelerations here as well?</p>
		
		<div class="infobox info">
			<p>As a side note, two of the six multiplications are squarings, which can be a little bit faster than regular multiplications.</p>
		</div>
		
		<p>Only a bit, with complex division, there is some sort of complex multiplication occuring, and we can bring down its four multiplications to three:</p>
		
		{{ code("complex_fast_division.c", "c") }}
		
		<p>This method does <span class="plt_green">6 additions</span>, <span class="plt_yellow">5 multiplications</span> and <span class="plt_red">2 divisions</span>.</p>
		
		<h2>Polar form</h2>
		
		<h2>Complex-base systems</h2>
		
		<h2>Sources</h2>
		
		<ol>
			<li>Aleksandr Cariow "An algorithm for dividing two complex numbers" (<a href="https://arxiv.org/abs/1608.07596">arxiv</a>)</li>
		</ol>
		
	</article>
</body>
</html>
